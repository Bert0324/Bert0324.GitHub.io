<<<<<<< HEAD
<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Bert's Blog</title><meta name="keywords" content="blog,javascript,typescript,code,frontend"><meta name="description" content="bert huang's blog"><link rel="icon" href="/assets/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/4.0.0/github-markdown.min.css" integrity="sha512-Oy18vBnbSJkXTndr2n6lDMO5NN31UljR8e/ICzVPrGpSud4Gkckb8yUpqhKuUNoE+o9gAb4O/rAxxw1ojyUVzg==" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/a11y-light.min.css" integrity="sha512-PW96n2amVglidqEDLPUdjJ0zByhT20poSqWJYZRutR6CP2QH58k96WmorqNnC4QXnosNeqMJM8FR/93isIifDQ==" crossorigin="anonymous"><link rel="stylesheet" href="/blog/style.css"></head><body><div><div class="container"><div class="side-bar"><img class="avatar" src="/assets/avatar.jpeg"><h1>Bert Huang</h1><p>一位兴趣广泛的前端程序员</p><nav><ul><li><a href="/blog/index.html">Index</a></li><li><a href="/blog/code.html">Code</a></li><li><a href="/blog/leetcode.html">LeetCode</a></li><li><a href="/blog/essay.html">Essay</a></li><li><a href="/blog/about.html">About</a></li></ul></nav><div id="social"><a href="https://github.com/Bert0324"><img class="social-avatar" src="https://github.githubassets.com/favicons/favicon.png"></a><a href="https://www.facebook.com/people/Yuchen-Huang/100005315205237"><img class="social-avatar" src="/assets/facebook.png"></a><a href="https://twitter.com/BertHuang5"><img class="social-avatar" src="/assets/twitter.png"></a></div><div class="views-count"><p id="busuanzi_container_site_uv" style="display:inline">total viewers: <span id="busuanzi_value_site_uv"></span></p></div></div><div class="post-content"><div class="search-field"><input class="search-input" placeholder="search"><div style="position:absolute"><div class="search-dropdown"><div class="dropdown-container"></div></div></div><button class="icon-font search-button"></button></div><div class="post-container"><div id="particles-js" style="position:fixed;height:100vh;width:100vw;z-index:-99"></div><div class="post-article"><article class="markdown-body"><div><div id="toc"><div class="last-edit"><p>Last Commit: 2023-09-16 17:23:28</p><p id="busuanzi_container_page_pv">views: <span id="busuanzi_value_page_pv"></span></p></div><div id="toc-body"><p><strong>Table of Content</strong></p><ul><li><a href="#console.log">console.log</a></li><li><a href="#v8%20debugger%20protocol">v8 debugger protocol</a></li><li><a href="#v8%20inspector%20protocol">v8 inspector protocol</a></li><li><a href="#vscode%u652F%u6301">vscode支持</a></li><li><a href="#typescript%u7684node%u8C03%u8BD5">typescript的node调试</a></li><ul><li><a href="#sourcemap%u7684%u65B9%u5F0F">sourcemap的方式</a></li><li><a href="#%u4F7F%u7528ts-node">使用ts-node</a></li></ul><li><a href="#addition%3A%20%u547D%u4EE4%u884C%u7684%u52A8%u6001ts%u5F15%u5165">addition: 命令行的动态ts引入</a></li><li><a href="#reference">reference</a></li></ul></div></div><div><h1 id="node%20dubug">Node Dubug</h1><p>本文的项目demo：<a href="https://github.com/Bert0324/node-debugger-demo">https://github.com/Bert0324/node-debugger-demo</a></p><p>众所周知，跑在node平台上的js是解释型的语言，因此断点调试必须要基于node的debug protocol，而非直接基于cpu的指令集。</p><p>较为主流的debug方式如下：</p><h2 id="console.log"><code>console.log</code></h2><p>兄弟们无须多言，对前端人员非常友好，与浏览器中调试一样，在代码中需要调试的地方直接写上，只是展示形式有所不同，在Node中是在终端命令行中打印。</p><p>这是最简单快速的调试手段，缺点也很明显，对原有代码入侵较大，在特定场景中使用较局限，而且不是同步的。</p><h2 id="v8%20debugger%20protocol">v8 Debugger Protocol</h2><p><a href="https://github.com/node-inspector/node-inspector">node-inspector</a>即是基于此protocol。但是已经被v8 Inspector Protocol取代。</p><h2 id="v8%20inspector%20protocol">v8 Inspector Protocol</h2><p>node提供了v8 Inspector Protocol，可以使用第三方的 Client/IDE 等监测和介入 Node(v8) 运行过程，进行调试。通过 websocket与 Client/IDE 交互，同时基于 Chrome/Chromium 浏览器的 devtools 提供了图形化的调试界面。</p><ul><li><code>yarn legacy</code></li><li><code>open http://localhost:5858/json/list</code></li><li>打开devtoolsFrontendUrl</li></ul><h2 id="vscode%u652F%u6301">VScode支持</h2><p>使用浏览器调试的确更符合前端的使用习惯，但是直接使用ide调试显然才是更高级的享受。这里用vscode做例子。</p><ul><li>打开JavaScript Debug Terminal (新打开一个vscode window必须要重新打开一个新的jdt)</li><li>attach breakpoints</li><li><code>yarn vscode</code></li></ul><p>配合nodemon更显丝滑。</p><h2 id="typescript%u7684node%u8C03%u8BD5">Typescript的node调试</h2><p>针对ts的调试，有两种方案。</p><h3 id="sourcemap%u7684%u65B9%u5F0F">sourceMap的方式</h3><p>在tsconfig.json上设置<code>&quot;sourceMap&quot;: true</code>。</p><ul><li><code>yarn ts</code></li></ul><h3 id="%u4F7F%u7528ts-node">使用ts-node</h3><p><a href="https://github.com/TypeStrong/ts-node">ts-node</a>已经集成了debug的功能，通过ts-node可以直接在vscode上调试。</p><ul><li>打开JavaScript Debug Terminal (新打开一个vscode window必须要重新打开一个新的jdt)</li><li>attach breakpoints</li><li><code>yarn tsnode</code></li></ul><h2 id="addition%3A%20%u547D%u4EE4%u884C%u7684%u52A8%u6001ts%u5F15%u5165">Addition: 命令行的动态ts引入</h2><pre><code class="language-ts"><span class="hljs-meta">#! /usr/bin/env node</span>
=======
<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Bert's Blog</title><meta name="keywords" content="blog,javascript,typescript,code,frontend"><meta name="description" content="bert huang's blog"><link rel="icon" href="/assets/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/4.0.0/github-markdown.min.css" integrity="sha512-Oy18vBnbSJkXTndr2n6lDMO5NN31UljR8e/ICzVPrGpSud4Gkckb8yUpqhKuUNoE+o9gAb4O/rAxxw1ojyUVzg==" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/a11y-light.min.css" integrity="sha512-PW96n2amVglidqEDLPUdjJ0zByhT20poSqWJYZRutR6CP2QH58k96WmorqNnC4QXnosNeqMJM8FR/93isIifDQ==" crossorigin="anonymous"><link rel="stylesheet" href="/blog/style.css"></head><body><div><div class="container"><div class="side-bar"><img class="avatar" src="/assets/avatar.jpeg"><h1>Bert Huang</h1><p>一位兴趣广泛的前端程序员</p><nav><ul><li><a href="/blog/index.html">Index</a></li><li><a href="/blog/code.html">Code</a></li><li><a href="/blog/leetcode.html">LeetCode</a></li><li><a href="/blog/essay.html">Essay</a></li><li><a href="/blog/about.html">About</a></li></ul></nav><div id="social"><a href="https://github.com/Bert0324"><img class="social-avatar" src="https://github.githubassets.com/favicons/favicon.png"></a><a href="https://www.facebook.com/people/Yuchen-Huang/100005315205237"><img class="social-avatar" src="/assets/facebook.png"></a><a href="https://twitter.com/BertHuang5"><img class="social-avatar" src="/assets/twitter.png"></a></div><div class="views-count"><p id="busuanzi_container_site_uv" style="display:inline">total viewers: <span id="busuanzi_value_site_uv"></span></p></div></div><div class="post-content"><div class="search-field"><input class="search-input" placeholder="search"><div style="position:absolute"><div class="search-dropdown"><div class="dropdown-container"></div></div></div><button class="icon-font search-button"></button></div><div class="post-container"><div id="particles-js" style="position:fixed;height:100vh;width:100vw;z-index:-99"></div><div class="post-article"><article class="markdown-body"><div><div id="toc"><div class="last-edit"><p>Last Commit: 2023-09-20 15:25:17</p><p id="busuanzi_container_page_pv">views: <span id="busuanzi_value_page_pv"></span></p></div><div id="toc-body"><p><strong>Table of Content</strong></p><ul><li><a href="#console.log">console.log</a></li><li><a href="#v8%20debugger%20protocol">v8 debugger protocol</a></li><li><a href="#v8%20inspector%20protocol">v8 inspector protocol</a></li><li><a href="#vscode%u652F%u6301">vscode支持</a></li><li><a href="#typescript%u7684node%u8C03%u8BD5">typescript的node调试</a></li><ul><li><a href="#sourcemap%u7684%u65B9%u5F0F">sourcemap的方式</a></li><li><a href="#%u4F7F%u7528ts-node">使用ts-node</a></li></ul><li><a href="#addition%3A%20%u547D%u4EE4%u884C%u7684%u52A8%u6001ts%u5F15%u5165">addition: 命令行的动态ts引入</a></li><li><a href="#reference">reference</a></li></ul></div></div><div><h1 id="node%20dubug">Node Dubug</h1><p>本文的项目demo：<a href="https://github.com/Bert0324/node-debugger-demo">https://github.com/Bert0324/node-debugger-demo</a></p><p>众所周知，跑在node平台上的js是解释型的语言，因此断点调试必须要基于node的debug protocol，而非直接基于cpu的指令集。</p><p>较为主流的debug方式如下：</p><h2 id="console.log"><code>console.log</code></h2><p>兄弟们无须多言，对前端人员非常友好，与浏览器中调试一样，在代码中需要调试的地方直接写上，只是展示形式有所不同，在Node中是在终端命令行中打印。</p><p>这是最简单快速的调试手段，缺点也很明显，对原有代码入侵较大，在特定场景中使用较局限，而且不是同步的。</p><h2 id="v8%20debugger%20protocol">v8 Debugger Protocol</h2><p><a href="https://github.com/node-inspector/node-inspector">node-inspector</a>即是基于此protocol。但是已经被v8 Inspector Protocol取代。</p><h2 id="v8%20inspector%20protocol">v8 Inspector Protocol</h2><p>node提供了v8 Inspector Protocol，可以使用第三方的 Client/IDE 等监测和介入 Node(v8) 运行过程，进行调试。通过 websocket与 Client/IDE 交互，同时基于 Chrome/Chromium 浏览器的 devtools 提供了图形化的调试界面。</p><ul><li><code>yarn legacy</code></li><li><code>open http://localhost:5858/json/list</code></li><li>打开devtoolsFrontendUrl</li></ul><h2 id="vscode%u652F%u6301">VScode支持</h2><p>使用浏览器调试的确更符合前端的使用习惯，但是直接使用ide调试显然才是更高级的享受。这里用vscode做例子。</p><ul><li>打开JavaScript Debug Terminal (新打开一个vscode window必须要重新打开一个新的jdt)</li><li>attach breakpoints</li><li><code>yarn vscode</code></li></ul><p>配合nodemon更显丝滑。</p><h2 id="typescript%u7684node%u8C03%u8BD5">Typescript的node调试</h2><p>针对ts的调试，有两种方案。</p><h3 id="sourcemap%u7684%u65B9%u5F0F">sourceMap的方式</h3><p>在tsconfig.json上设置<code>&quot;sourceMap&quot;: true</code>。</p><ul><li><code>yarn ts</code></li></ul><h3 id="%u4F7F%u7528ts-node">使用ts-node</h3><p><a href="https://github.com/TypeStrong/ts-node">ts-node</a>已经集成了debug的功能，通过ts-node可以直接在vscode上调试。</p><ul><li>打开JavaScript Debug Terminal (新打开一个vscode window必须要重新打开一个新的jdt)</li><li>attach breakpoints</li><li><code>yarn tsnode</code></li></ul><h2 id="addition%3A%20%u547D%u4EE4%u884C%u7684%u52A8%u6001ts%u5F15%u5165">Addition: 命令行的动态ts引入</h2><pre><code class="language-ts"><span class="hljs-meta">#! /usr/bin/env node</span>
>>>>>>> f924d18eedd3a74cdb2d657d18713483df6d7a86
<span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;ts-node&#x27;</span>).register({
  <span class="hljs-attr">typeCheck</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">files</span>: <span class="hljs-literal">true</span>,
});
<span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./bin&#x27;</span>);
</code></pre><h2 id="reference">Reference</h2><ul><li><a href="https://v8.dev/docs/inspector">https://v8.dev/docs/inspector</a></li></ul></div></div></article></div></div><div id="reminder" style="display:none">Facebook Comments Service is unavailable</div></div></div></div></body><script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script><script async defer="defer" crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v9.0" nonce="BSCiWiHI"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-0SEZ9KRGY7"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script async src="https://cdnjs.cloudflare.com/ajax/libs/FlexSearch/0.6.22/flexsearch.min.js"></script><script src="/blog/index.js"></script></html>